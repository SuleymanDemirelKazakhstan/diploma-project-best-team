{"ast":null,"code":"import { extends as _extends, objectWithoutPropertiesLoose as _objectWithoutPropertiesLoose, createForOfIteratorHelperLoose as _createForOfIteratorHelperLoose } from '../../_virtual/_rollupPluginBabelHelpers.js';\nimport React, { useReducer, useEffect, useMemo, useContext, useCallback, createContext, useRef, useState } from 'react';\nimport { match } from '../../utils/match.esm.js';\nimport { render, forwardRefWithAs, Features } from '../../utils/render.esm.js';\nimport { useSyncRefs } from '../../hooks/use-sync-refs.esm.js';\nimport { Keys } from '../keyboard.esm.js';\nimport { isDisabledReactIssue7711 } from '../../utils/bugs.esm.js';\nimport { useId } from '../../hooks/use-id.esm.js';\nimport { isFocusableElement, getFocusableElements, focusIn, Focus, FocusResult, FocusableMode } from '../../utils/focus-management.esm.js';\nimport { useWindowEvent } from '../../hooks/use-window-event.esm.js';\nimport { OpenClosedProvider, State, useOpenClosed } from '../../internal/open-closed.esm.js';\nimport { useResolveButtonType } from '../../hooks/use-resolve-button-type.esm.js';\n\nvar _reducers;\n\nvar PopoverStates;\n\n(function (PopoverStates) {\n  PopoverStates[PopoverStates[\"Open\"] = 0] = \"Open\";\n  PopoverStates[PopoverStates[\"Closed\"] = 1] = \"Closed\";\n})(PopoverStates || (PopoverStates = {}));\n\nvar ActionTypes;\n\n(function (ActionTypes) {\n  ActionTypes[ActionTypes[\"TogglePopover\"] = 0] = \"TogglePopover\";\n  ActionTypes[ActionTypes[\"ClosePopover\"] = 1] = \"ClosePopover\";\n  ActionTypes[ActionTypes[\"SetButton\"] = 2] = \"SetButton\";\n  ActionTypes[ActionTypes[\"SetButtonId\"] = 3] = \"SetButtonId\";\n  ActionTypes[ActionTypes[\"SetPanel\"] = 4] = \"SetPanel\";\n  ActionTypes[ActionTypes[\"SetPanelId\"] = 5] = \"SetPanelId\";\n})(ActionTypes || (ActionTypes = {}));\n\nvar reducers = (_reducers = {}, _reducers[ActionTypes.TogglePopover] = function (state) {\n  var _match;\n\n  return _extends({}, state, {\n    popoverState: match(state.popoverState, (_match = {}, _match[PopoverStates.Open] = PopoverStates.Closed, _match[PopoverStates.Closed] = PopoverStates.Open, _match))\n  });\n}, _reducers[ActionTypes.ClosePopover] = function (state) {\n  if (state.popoverState === PopoverStates.Closed) return state;\n  return _extends({}, state, {\n    popoverState: PopoverStates.Closed\n  });\n}, _reducers[ActionTypes.SetButton] = function (state, action) {\n  if (state.button === action.button) return state;\n  return _extends({}, state, {\n    button: action.button\n  });\n}, _reducers[ActionTypes.SetButtonId] = function (state, action) {\n  if (state.buttonId === action.buttonId) return state;\n  return _extends({}, state, {\n    buttonId: action.buttonId\n  });\n}, _reducers[ActionTypes.SetPanel] = function (state, action) {\n  if (state.panel === action.panel) return state;\n  return _extends({}, state, {\n    panel: action.panel\n  });\n}, _reducers[ActionTypes.SetPanelId] = function (state, action) {\n  if (state.panelId === action.panelId) return state;\n  return _extends({}, state, {\n    panelId: action.panelId\n  });\n}, _reducers);\nvar PopoverContext = /*#__PURE__*/createContext(null);\nPopoverContext.displayName = 'PopoverContext';\n\nfunction usePopoverContext(component) {\n  var context = useContext(PopoverContext);\n\n  if (context === null) {\n    var err = new Error(\"<\" + component + \" /> is missing a parent <\" + Popover.name + \" /> component.\");\n    if (Error.captureStackTrace) Error.captureStackTrace(err, usePopoverContext);\n    throw err;\n  }\n\n  return context;\n}\n\nvar PopoverAPIContext = /*#__PURE__*/createContext(null);\nPopoverAPIContext.displayName = 'PopoverAPIContext';\n\nfunction usePopoverAPIContext(component) {\n  var context = useContext(PopoverAPIContext);\n\n  if (context === null) {\n    var err = new Error(\"<\" + component + \" /> is missing a parent <\" + Popover.name + \" /> component.\");\n    if (Error.captureStackTrace) Error.captureStackTrace(err, usePopoverAPIContext);\n    throw err;\n  }\n\n  return context;\n}\n\nvar PopoverGroupContext = /*#__PURE__*/createContext(null);\nPopoverGroupContext.displayName = 'PopoverGroupContext';\n\nfunction usePopoverGroupContext() {\n  return useContext(PopoverGroupContext);\n}\n\nvar PopoverPanelContext = /*#__PURE__*/createContext(null);\nPopoverPanelContext.displayName = 'PopoverPanelContext';\n\nfunction usePopoverPanelContext() {\n  return useContext(PopoverPanelContext);\n}\n\nfunction stateReducer(state, action) {\n  return match(action.type, reducers, state, action);\n} // ---\n\n\nvar DEFAULT_POPOVER_TAG = 'div';\n\nfunction Popover(props) {\n  var _match2;\n\n  var buttonId = \"headlessui-popover-button-\" + useId();\n  var panelId = \"headlessui-popover-panel-\" + useId();\n  var reducerBag = useReducer(stateReducer, {\n    popoverState: PopoverStates.Closed,\n    button: null,\n    buttonId: buttonId,\n    panel: null,\n    panelId: panelId\n  });\n  var _reducerBag$ = reducerBag[0],\n      popoverState = _reducerBag$.popoverState,\n      button = _reducerBag$.button,\n      panel = _reducerBag$.panel,\n      dispatch = reducerBag[1];\n  useEffect(function () {\n    return dispatch({\n      type: ActionTypes.SetButtonId,\n      buttonId: buttonId\n    });\n  }, [buttonId, dispatch]);\n  useEffect(function () {\n    return dispatch({\n      type: ActionTypes.SetPanelId,\n      panelId: panelId\n    });\n  }, [panelId, dispatch]);\n  var registerBag = useMemo(function () {\n    return {\n      buttonId: buttonId,\n      panelId: panelId,\n      close: function close() {\n        return dispatch({\n          type: ActionTypes.ClosePopover\n        });\n      }\n    };\n  }, [buttonId, panelId, dispatch]);\n  var groupContext = usePopoverGroupContext();\n  var registerPopover = groupContext == null ? void 0 : groupContext.registerPopover;\n  var isFocusWithinPopoverGroup = useCallback(function () {\n    var _groupContext$isFocus;\n\n    return (_groupContext$isFocus = groupContext == null ? void 0 : groupContext.isFocusWithinPopoverGroup()) != null ? _groupContext$isFocus : (button == null ? void 0 : button.contains(document.activeElement)) || (panel == null ? void 0 : panel.contains(document.activeElement));\n  }, [groupContext, button, panel]);\n  useEffect(function () {\n    return registerPopover == null ? void 0 : registerPopover(registerBag);\n  }, [registerPopover, registerBag]); // Handle focus out\n\n  useWindowEvent('focus', function () {\n    if (popoverState !== PopoverStates.Open) return;\n    if (isFocusWithinPopoverGroup()) return;\n    if (!button) return;\n    if (!panel) return;\n    dispatch({\n      type: ActionTypes.ClosePopover\n    });\n  }, true); // Handle outside click\n\n  useWindowEvent('mousedown', function (event) {\n    var target = event.target;\n    if (popoverState !== PopoverStates.Open) return;\n    if (button == null ? void 0 : button.contains(target)) return;\n    if (panel == null ? void 0 : panel.contains(target)) return;\n    dispatch({\n      type: ActionTypes.ClosePopover\n    });\n\n    if (!isFocusableElement(target, FocusableMode.Loose)) {\n      event.preventDefault();\n      button == null ? void 0 : button.focus();\n    }\n  });\n  var close = useCallback(function (focusableElement) {\n    dispatch({\n      type: ActionTypes.ClosePopover\n    });\n\n    var restoreElement = function () {\n      if (!focusableElement) return button;\n      if (focusableElement instanceof HTMLElement) return focusableElement;\n      if (focusableElement.current instanceof HTMLElement) return focusableElement.current;\n      return button;\n    }();\n\n    restoreElement == null ? void 0 : restoreElement.focus();\n  }, [dispatch, button]);\n  var api = useMemo(function () {\n    return {\n      close: close\n    };\n  }, [close]);\n  var slot = useMemo(function () {\n    return {\n      open: popoverState === PopoverStates.Open,\n      close: close\n    };\n  }, [popoverState, close]);\n  return React.createElement(PopoverContext.Provider, {\n    value: reducerBag\n  }, React.createElement(PopoverAPIContext.Provider, {\n    value: api\n  }, React.createElement(OpenClosedProvider, {\n    value: match(popoverState, (_match2 = {}, _match2[PopoverStates.Open] = State.Open, _match2[PopoverStates.Closed] = State.Closed, _match2))\n  }, render({\n    props: props,\n    slot: slot,\n    defaultTag: DEFAULT_POPOVER_TAG,\n    name: 'Popover'\n  }))));\n} // ---\n\n\nvar DEFAULT_BUTTON_TAG = 'button';\nvar Button = /*#__PURE__*/forwardRefWithAs(function Button(props, ref) {\n  var _usePopoverContext = usePopoverContext([Popover.name, Button.name].join('.')),\n      state = _usePopoverContext[0],\n      dispatch = _usePopoverContext[1];\n\n  var internalButtonRef = useRef(null);\n  var groupContext = usePopoverGroupContext();\n  var closeOthers = groupContext == null ? void 0 : groupContext.closeOthers;\n  var panelContext = usePopoverPanelContext();\n  var isWithinPanel = panelContext === null ? false : panelContext === state.panelId;\n  var buttonRef = useSyncRefs(internalButtonRef, ref, isWithinPanel ? null : function (button) {\n    return dispatch({\n      type: ActionTypes.SetButton,\n      button: button\n    });\n  });\n  var withinPanelButtonRef = useSyncRefs(internalButtonRef, ref); // TODO: Revisit when handling Tab/Shift+Tab when using Portal's\n\n  var activeElementRef = useRef(null);\n  var previousActiveElementRef = useRef(typeof window === 'undefined' ? null : document.activeElement);\n  useWindowEvent('focus', function () {\n    previousActiveElementRef.current = activeElementRef.current;\n    activeElementRef.current = document.activeElement;\n  }, true);\n  var handleKeyDown = useCallback(function (event) {\n    var _state$button;\n\n    if (isWithinPanel) {\n      if (state.popoverState === PopoverStates.Closed) return;\n\n      switch (event.key) {\n        case Keys.Space:\n        case Keys.Enter:\n          event.preventDefault(); // Prevent triggering a *click* event\n\n          event.stopPropagation();\n          dispatch({\n            type: ActionTypes.ClosePopover\n          });\n          (_state$button = state.button) == null ? void 0 : _state$button.focus(); // Re-focus the original opening Button\n\n          break;\n      }\n    } else {\n      switch (event.key) {\n        case Keys.Space:\n        case Keys.Enter:\n          event.preventDefault(); // Prevent triggering a *click* event\n\n          event.stopPropagation();\n          if (state.popoverState === PopoverStates.Closed) closeOthers == null ? void 0 : closeOthers(state.buttonId);\n          dispatch({\n            type: ActionTypes.TogglePopover\n          });\n          break;\n\n        case Keys.Escape:\n          if (state.popoverState !== PopoverStates.Open) return closeOthers == null ? void 0 : closeOthers(state.buttonId);\n          if (!internalButtonRef.current) return;\n          if (!internalButtonRef.current.contains(document.activeElement)) return;\n          event.preventDefault();\n          event.stopPropagation();\n          dispatch({\n            type: ActionTypes.ClosePopover\n          });\n          break;\n\n        case Keys.Tab:\n          if (state.popoverState !== PopoverStates.Open) return;\n          if (!state.panel) return;\n          if (!state.button) return; // TODO: Revisit when handling Tab/Shift+Tab when using Portal's\n\n          if (event.shiftKey) {\n            var _state$button2; // Check if the last focused element exists, and check that it is not inside button or panel itself\n\n\n            if (!previousActiveElementRef.current) return;\n            if ((_state$button2 = state.button) == null ? void 0 : _state$button2.contains(previousActiveElementRef.current)) return;\n            if (state.panel.contains(previousActiveElementRef.current)) return; // Check if the last focused element is *after* the button in the DOM\n\n            var focusableElements = getFocusableElements();\n            var previousIdx = focusableElements.indexOf(previousActiveElementRef.current);\n            var buttonIdx = focusableElements.indexOf(state.button);\n            if (buttonIdx > previousIdx) return;\n            event.preventDefault();\n            event.stopPropagation();\n            focusIn(state.panel, Focus.Last);\n          } else {\n            event.preventDefault();\n            event.stopPropagation();\n            focusIn(state.panel, Focus.First);\n          }\n\n          break;\n      }\n    }\n  }, [dispatch, state.popoverState, state.buttonId, state.button, state.panel, internalButtonRef, closeOthers, isWithinPanel]);\n  var handleKeyUp = useCallback(function (event) {\n    var _state$button3;\n\n    if (isWithinPanel) return;\n\n    if (event.key === Keys.Space) {\n      // Required for firefox, event.preventDefault() in handleKeyDown for\n      // the Space key doesn't cancel the handleKeyUp, which in turn\n      // triggers a *click*.\n      event.preventDefault();\n    }\n\n    if (state.popoverState !== PopoverStates.Open) return;\n    if (!state.panel) return;\n    if (!state.button) return; // TODO: Revisit when handling Tab/Shift+Tab when using Portal's\n\n    switch (event.key) {\n      case Keys.Tab:\n        // Check if the last focused element exists, and check that it is not inside button or panel itself\n        if (!previousActiveElementRef.current) return;\n        if ((_state$button3 = state.button) == null ? void 0 : _state$button3.contains(previousActiveElementRef.current)) return;\n        if (state.panel.contains(previousActiveElementRef.current)) return; // Check if the last focused element is *after* the button in the DOM\n\n        var focusableElements = getFocusableElements();\n        var previousIdx = focusableElements.indexOf(previousActiveElementRef.current);\n        var buttonIdx = focusableElements.indexOf(state.button);\n        if (buttonIdx > previousIdx) return;\n        event.preventDefault();\n        event.stopPropagation();\n        focusIn(state.panel, Focus.Last);\n        break;\n    }\n  }, [state.popoverState, state.panel, state.button, isWithinPanel]);\n  var handleClick = useCallback(function (event) {\n    if (isDisabledReactIssue7711(event.currentTarget)) return;\n    if (props.disabled) return;\n\n    if (isWithinPanel) {\n      var _state$button4;\n\n      dispatch({\n        type: ActionTypes.ClosePopover\n      });\n      (_state$button4 = state.button) == null ? void 0 : _state$button4.focus(); // Re-focus the original opening Button\n    } else {\n      var _state$button5;\n\n      if (state.popoverState === PopoverStates.Closed) closeOthers == null ? void 0 : closeOthers(state.buttonId);\n      (_state$button5 = state.button) == null ? void 0 : _state$button5.focus();\n      dispatch({\n        type: ActionTypes.TogglePopover\n      });\n    }\n  }, [dispatch, state.button, state.popoverState, state.buttonId, props.disabled, closeOthers, isWithinPanel]);\n  var slot = useMemo(function () {\n    return {\n      open: state.popoverState === PopoverStates.Open\n    };\n  }, [state]);\n  var type = useResolveButtonType(props, internalButtonRef);\n  var passthroughProps = props;\n  var propsWeControl = isWithinPanel ? {\n    ref: withinPanelButtonRef,\n    type: type,\n    onKeyDown: handleKeyDown,\n    onClick: handleClick\n  } : {\n    ref: buttonRef,\n    id: state.buttonId,\n    type: type,\n    'aria-expanded': props.disabled ? undefined : state.popoverState === PopoverStates.Open,\n    'aria-controls': state.panel ? state.panelId : undefined,\n    onKeyDown: handleKeyDown,\n    onKeyUp: handleKeyUp,\n    onClick: handleClick\n  };\n  return render({\n    props: _extends({}, passthroughProps, propsWeControl),\n    slot: slot,\n    defaultTag: DEFAULT_BUTTON_TAG,\n    name: 'Popover.Button'\n  });\n}); // ---\n\nvar DEFAULT_OVERLAY_TAG = 'div';\nvar OverlayRenderFeatures = Features.RenderStrategy | Features.Static;\nvar Overlay = /*#__PURE__*/forwardRefWithAs(function Overlay(props, ref) {\n  var _usePopoverContext2 = usePopoverContext([Popover.name, Overlay.name].join('.')),\n      popoverState = _usePopoverContext2[0].popoverState,\n      dispatch = _usePopoverContext2[1];\n\n  var overlayRef = useSyncRefs(ref);\n  var id = \"headlessui-popover-overlay-\" + useId();\n  var usesOpenClosedState = useOpenClosed();\n\n  var visible = function () {\n    if (usesOpenClosedState !== null) {\n      return usesOpenClosedState === State.Open;\n    }\n\n    return popoverState === PopoverStates.Open;\n  }();\n\n  var handleClick = useCallback(function (event) {\n    if (isDisabledReactIssue7711(event.currentTarget)) return event.preventDefault();\n    dispatch({\n      type: ActionTypes.ClosePopover\n    });\n  }, [dispatch]);\n  var slot = useMemo(function () {\n    return {\n      open: popoverState === PopoverStates.Open\n    };\n  }, [popoverState]);\n  var propsWeControl = {\n    ref: overlayRef,\n    id: id,\n    'aria-hidden': true,\n    onClick: handleClick\n  };\n  var passthroughProps = props;\n  return render({\n    props: _extends({}, passthroughProps, propsWeControl),\n    slot: slot,\n    defaultTag: DEFAULT_OVERLAY_TAG,\n    features: OverlayRenderFeatures,\n    visible: visible,\n    name: 'Popover.Overlay'\n  });\n}); // ---\n\nvar DEFAULT_PANEL_TAG = 'div';\nvar PanelRenderFeatures = Features.RenderStrategy | Features.Static;\nvar Panel = /*#__PURE__*/forwardRefWithAs(function Panel(props, ref) {\n  var _props$focus = props.focus,\n      focus = _props$focus === void 0 ? false : _props$focus,\n      passthroughProps = _objectWithoutPropertiesLoose(props, [\"focus\"]);\n\n  var _usePopoverContext3 = usePopoverContext([Popover.name, Panel.name].join('.')),\n      state = _usePopoverContext3[0],\n      dispatch = _usePopoverContext3[1];\n\n  var _usePopoverAPIContext = usePopoverAPIContext([Popover.name, Panel.name].join('.')),\n      close = _usePopoverAPIContext.close;\n\n  var internalPanelRef = useRef(null);\n  var panelRef = useSyncRefs(internalPanelRef, ref, function (panel) {\n    dispatch({\n      type: ActionTypes.SetPanel,\n      panel: panel\n    });\n  });\n  var usesOpenClosedState = useOpenClosed();\n\n  var visible = function () {\n    if (usesOpenClosedState !== null) {\n      return usesOpenClosedState === State.Open;\n    }\n\n    return state.popoverState === PopoverStates.Open;\n  }();\n\n  var handleKeyDown = useCallback(function (event) {\n    var _state$button6;\n\n    switch (event.key) {\n      case Keys.Escape:\n        if (state.popoverState !== PopoverStates.Open) return;\n        if (!internalPanelRef.current) return;\n        if (!internalPanelRef.current.contains(document.activeElement)) return;\n        event.preventDefault();\n        event.stopPropagation();\n        dispatch({\n          type: ActionTypes.ClosePopover\n        });\n        (_state$button6 = state.button) == null ? void 0 : _state$button6.focus();\n        break;\n    }\n  }, [state, internalPanelRef, dispatch]); // Unlink on \"unmount\" myself\n\n  useEffect(function () {\n    return function () {\n      return dispatch({\n        type: ActionTypes.SetPanel,\n        panel: null\n      });\n    };\n  }, [dispatch]); // Unlink on \"unmount\" children\n\n  useEffect(function () {\n    var _props$unmount;\n\n    if (props[\"static\"]) return;\n\n    if (state.popoverState === PopoverStates.Closed && ((_props$unmount = props.unmount) != null ? _props$unmount : true)) {\n      dispatch({\n        type: ActionTypes.SetPanel,\n        panel: null\n      });\n    }\n  }, [state.popoverState, props.unmount, props[\"static\"], dispatch]); // Move focus within panel\n\n  useEffect(function () {\n    if (!focus) return;\n    if (state.popoverState !== PopoverStates.Open) return;\n    if (!internalPanelRef.current) return;\n    var activeElement = document.activeElement;\n    if (internalPanelRef.current.contains(activeElement)) return; // Already focused within Dialog\n\n    focusIn(internalPanelRef.current, Focus.First);\n  }, [focus, internalPanelRef, state.popoverState]); // Handle Tab / Shift+Tab focus positioning\n\n  useWindowEvent('keydown', function (event) {\n    if (state.popoverState !== PopoverStates.Open) return;\n    if (!internalPanelRef.current) return;\n    if (event.key !== Keys.Tab) return;\n    if (!document.activeElement) return;\n    if (!internalPanelRef.current) return;\n    if (!internalPanelRef.current.contains(document.activeElement)) return; // We will take-over the default tab behaviour so that we have a bit\n    // control over what is focused next. It will behave exactly the same,\n    // but it will also \"fix\" some issues based on whether you are using a\n    // Portal or not.\n\n    event.preventDefault();\n    var result = focusIn(internalPanelRef.current, event.shiftKey ? Focus.Previous : Focus.Next);\n\n    if (result === FocusResult.Underflow) {\n      var _state$button7;\n\n      return (_state$button7 = state.button) == null ? void 0 : _state$button7.focus();\n    } else if (result === FocusResult.Overflow) {\n      if (!state.button) return;\n      var elements = getFocusableElements();\n      var buttonIdx = elements.indexOf(state.button);\n      var nextElements = elements.splice(buttonIdx + 1) // Elements after button\n      .filter(function (element) {\n        var _internalPanelRef$cur;\n\n        return !((_internalPanelRef$cur = internalPanelRef.current) == null ? void 0 : _internalPanelRef$cur.contains(element));\n      }); // Ignore items in panel\n      // Try to focus the next element, however it could fail if we are in a\n      // Portal that happens to be the very last one in the DOM. In that\n      // case we would Error (because nothing after the button is\n      // focusable). Therefore we will try and focus the very first item in\n      // the document.body.\n\n      if (focusIn(nextElements, Focus.First) === FocusResult.Error) {\n        focusIn(document.body, Focus.First);\n      }\n    }\n  }); // Handle focus out when we are in special \"focus\" mode\n\n  useWindowEvent('focus', function () {\n    var _internalPanelRef$cur2;\n\n    if (!focus) return;\n    if (state.popoverState !== PopoverStates.Open) return;\n    if (!internalPanelRef.current) return;\n    if ((_internalPanelRef$cur2 = internalPanelRef.current) == null ? void 0 : _internalPanelRef$cur2.contains(document.activeElement)) return;\n    dispatch({\n      type: ActionTypes.ClosePopover\n    });\n  }, true);\n  var slot = useMemo(function () {\n    return {\n      open: state.popoverState === PopoverStates.Open,\n      close: close\n    };\n  }, [state, close]);\n  var propsWeControl = {\n    ref: panelRef,\n    id: state.panelId,\n    onKeyDown: handleKeyDown\n  };\n  return React.createElement(PopoverPanelContext.Provider, {\n    value: state.panelId\n  }, render({\n    props: _extends({}, passthroughProps, propsWeControl),\n    slot: slot,\n    defaultTag: DEFAULT_PANEL_TAG,\n    features: PanelRenderFeatures,\n    visible: visible,\n    name: 'Popover.Panel'\n  }));\n}); // ---\n\nvar DEFAULT_GROUP_TAG = 'div';\n\nfunction Group(props) {\n  var groupRef = useRef(null);\n\n  var _useState = useState([]),\n      popovers = _useState[0],\n      setPopovers = _useState[1];\n\n  var unregisterPopover = useCallback(function (registerbag) {\n    setPopovers(function (existing) {\n      var idx = existing.indexOf(registerbag);\n\n      if (idx !== -1) {\n        var clone = existing.slice();\n        clone.splice(idx, 1);\n        return clone;\n      }\n\n      return existing;\n    });\n  }, [setPopovers]);\n  var registerPopover = useCallback(function (registerbag) {\n    setPopovers(function (existing) {\n      return [].concat(existing, [registerbag]);\n    });\n    return function () {\n      return unregisterPopover(registerbag);\n    };\n  }, [setPopovers, unregisterPopover]);\n  var isFocusWithinPopoverGroup = useCallback(function () {\n    var _groupRef$current;\n\n    var element = document.activeElement;\n    if ((_groupRef$current = groupRef.current) == null ? void 0 : _groupRef$current.contains(element)) return true; // Check if the focus is in one of the button or panel elements. This is important in case you are rendering inside a Portal.\n\n    return popovers.some(function (bag) {\n      var _document$getElementB, _document$getElementB2;\n\n      return ((_document$getElementB = document.getElementById(bag.buttonId)) == null ? void 0 : _document$getElementB.contains(element)) || ((_document$getElementB2 = document.getElementById(bag.panelId)) == null ? void 0 : _document$getElementB2.contains(element));\n    });\n  }, [groupRef, popovers]);\n  var closeOthers = useCallback(function (buttonId) {\n    for (var _iterator = _createForOfIteratorHelperLoose(popovers), _step; !(_step = _iterator()).done;) {\n      var popover = _step.value;\n      if (popover.buttonId !== buttonId) popover.close();\n    }\n  }, [popovers]);\n  var contextBag = useMemo(function () {\n    return {\n      registerPopover: registerPopover,\n      unregisterPopover: unregisterPopover,\n      isFocusWithinPopoverGroup: isFocusWithinPopoverGroup,\n      closeOthers: closeOthers\n    };\n  }, [registerPopover, unregisterPopover, isFocusWithinPopoverGroup, closeOthers]);\n  var slot = useMemo(function () {\n    return {};\n  }, []);\n  var propsWeControl = {\n    ref: groupRef\n  };\n  var passthroughProps = props;\n  return React.createElement(PopoverGroupContext.Provider, {\n    value: contextBag\n  }, render({\n    props: _extends({}, passthroughProps, propsWeControl),\n    slot: slot,\n    defaultTag: DEFAULT_GROUP_TAG,\n    name: 'Popover.Group'\n  }));\n} // ---\n\n\nPopover.Button = Button;\nPopover.Overlay = Overlay;\nPopover.Panel = Panel;\nPopover.Group = Group;\nexport { Popover };","map":{"version":3,"mappings":"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","names":["extends","_extends","objectWithoutPropertiesLoose","_objectWithoutPropertiesLoose","createForOfIteratorHelperLoose","_createForOfIteratorHelperLoose","React","useReducer","useEffect","useMemo","useContext","useCallback","createContext","useRef","useState","match","render","forwardRefWithAs","Features","useSyncRefs","Keys","isDisabledReactIssue7711","useId","isFocusableElement","getFocusableElements","focusIn","Focus","FocusResult","FocusableMode","useWindowEvent","OpenClosedProvider","State","useOpenClosed","useResolveButtonType","_reducers","PopoverStates","ActionTypes","reducers","TogglePopover","state","_match","popoverState","Open","Closed","ClosePopover","SetButton","action","button","SetButtonId","buttonId","SetPanel","panel","SetPanelId","panelId","PopoverContext","displayName","usePopoverContext","component","context","err","Error","Popover","name","captureStackTrace","PopoverAPIContext","usePopoverAPIContext","PopoverGroupContext","usePopoverGroupContext","PopoverPanelContext","usePopoverPanelContext","stateReducer","type","DEFAULT_POPOVER_TAG","props","_match2","reducerBag","_reducerBag$","dispatch","registerBag","close","groupContext","registerPopover","isFocusWithinPopoverGroup","_groupContext$isFocus","contains","document","activeElement","event","target","Loose","preventDefault","focus","focusableElement","restoreElement","HTMLElement","current","api","slot","open","createElement","Provider","value","defaultTag","DEFAULT_BUTTON_TAG","Button","ref","_usePopoverContext","join","internalButtonRef","closeOthers","panelContext","isWithinPanel","buttonRef","withinPanelButtonRef","activeElementRef","previousActiveElementRef","window","handleKeyDown","_state$button","key","Space","Enter","stopPropagation","Escape","Tab","shiftKey","_state$button2","focusableElements","previousIdx","indexOf","buttonIdx","Last","First","handleKeyUp","_state$button3","handleClick","currentTarget","disabled","_state$button4","_state$button5","passthroughProps","propsWeControl","onKeyDown","onClick","id","undefined","onKeyUp","DEFAULT_OVERLAY_TAG","OverlayRenderFeatures","RenderStrategy","Static","Overlay","_usePopoverContext2","overlayRef","usesOpenClosedState","visible","features","DEFAULT_PANEL_TAG","PanelRenderFeatures","Panel","_props$focus","_usePopoverContext3","_usePopoverAPIContext","internalPanelRef","panelRef","_state$button6","_props$unmount","unmount","result","Previous","Next","Underflow","_state$button7","Overflow","elements","nextElements","splice","filter","element","_internalPanelRef$cur","body","_internalPanelRef$cur2","DEFAULT_GROUP_TAG","Group","groupRef","_useState","popovers","setPopovers","unregisterPopover","registerbag","existing","idx","clone","slice","concat","_groupRef$current","some","bag","_document$getElementB","_document$getElementB2","getElementById","_iterator","_step","done","popover","contextBag"],"sources":["C:/Users/Joka24/Desktop/diplom/node_modules/@headlessui/react/dist/components/popover/popover.esm.js"],"sourcesContent":["import { extends as _extends, objectWithoutPropertiesLoose as _objectWithoutPropertiesLoose, createForOfIteratorHelperLoose as _createForOfIteratorHelperLoose } from '../../_virtual/_rollupPluginBabelHelpers.js';\nimport React, { useReducer, useEffect, useMemo, useContext, useCallback, createContext, useRef, useState } from 'react';\nimport { match } from '../../utils/match.esm.js';\nimport { render, forwardRefWithAs, Features } from '../../utils/render.esm.js';\nimport { useSyncRefs } from '../../hooks/use-sync-refs.esm.js';\nimport { Keys } from '../keyboard.esm.js';\nimport { isDisabledReactIssue7711 } from '../../utils/bugs.esm.js';\nimport { useId } from '../../hooks/use-id.esm.js';\nimport { isFocusableElement, getFocusableElements, focusIn, Focus, FocusResult, FocusableMode } from '../../utils/focus-management.esm.js';\nimport { useWindowEvent } from '../../hooks/use-window-event.esm.js';\nimport { OpenClosedProvider, State, useOpenClosed } from '../../internal/open-closed.esm.js';\nimport { useResolveButtonType } from '../../hooks/use-resolve-button-type.esm.js';\n\nvar _reducers;\nvar PopoverStates;\n\n(function (PopoverStates) {\n  PopoverStates[PopoverStates[\"Open\"] = 0] = \"Open\";\n  PopoverStates[PopoverStates[\"Closed\"] = 1] = \"Closed\";\n})(PopoverStates || (PopoverStates = {}));\n\nvar ActionTypes;\n\n(function (ActionTypes) {\n  ActionTypes[ActionTypes[\"TogglePopover\"] = 0] = \"TogglePopover\";\n  ActionTypes[ActionTypes[\"ClosePopover\"] = 1] = \"ClosePopover\";\n  ActionTypes[ActionTypes[\"SetButton\"] = 2] = \"SetButton\";\n  ActionTypes[ActionTypes[\"SetButtonId\"] = 3] = \"SetButtonId\";\n  ActionTypes[ActionTypes[\"SetPanel\"] = 4] = \"SetPanel\";\n  ActionTypes[ActionTypes[\"SetPanelId\"] = 5] = \"SetPanelId\";\n})(ActionTypes || (ActionTypes = {}));\n\nvar reducers = (_reducers = {}, _reducers[ActionTypes.TogglePopover] = function (state) {\n  var _match;\n\n  return _extends({}, state, {\n    popoverState: match(state.popoverState, (_match = {}, _match[PopoverStates.Open] = PopoverStates.Closed, _match[PopoverStates.Closed] = PopoverStates.Open, _match))\n  });\n}, _reducers[ActionTypes.ClosePopover] = function (state) {\n  if (state.popoverState === PopoverStates.Closed) return state;\n  return _extends({}, state, {\n    popoverState: PopoverStates.Closed\n  });\n}, _reducers[ActionTypes.SetButton] = function (state, action) {\n  if (state.button === action.button) return state;\n  return _extends({}, state, {\n    button: action.button\n  });\n}, _reducers[ActionTypes.SetButtonId] = function (state, action) {\n  if (state.buttonId === action.buttonId) return state;\n  return _extends({}, state, {\n    buttonId: action.buttonId\n  });\n}, _reducers[ActionTypes.SetPanel] = function (state, action) {\n  if (state.panel === action.panel) return state;\n  return _extends({}, state, {\n    panel: action.panel\n  });\n}, _reducers[ActionTypes.SetPanelId] = function (state, action) {\n  if (state.panelId === action.panelId) return state;\n  return _extends({}, state, {\n    panelId: action.panelId\n  });\n}, _reducers);\nvar PopoverContext = /*#__PURE__*/createContext(null);\nPopoverContext.displayName = 'PopoverContext';\n\nfunction usePopoverContext(component) {\n  var context = useContext(PopoverContext);\n\n  if (context === null) {\n    var err = new Error(\"<\" + component + \" /> is missing a parent <\" + Popover.name + \" /> component.\");\n    if (Error.captureStackTrace) Error.captureStackTrace(err, usePopoverContext);\n    throw err;\n  }\n\n  return context;\n}\n\nvar PopoverAPIContext = /*#__PURE__*/createContext(null);\nPopoverAPIContext.displayName = 'PopoverAPIContext';\n\nfunction usePopoverAPIContext(component) {\n  var context = useContext(PopoverAPIContext);\n\n  if (context === null) {\n    var err = new Error(\"<\" + component + \" /> is missing a parent <\" + Popover.name + \" /> component.\");\n    if (Error.captureStackTrace) Error.captureStackTrace(err, usePopoverAPIContext);\n    throw err;\n  }\n\n  return context;\n}\n\nvar PopoverGroupContext = /*#__PURE__*/createContext(null);\nPopoverGroupContext.displayName = 'PopoverGroupContext';\n\nfunction usePopoverGroupContext() {\n  return useContext(PopoverGroupContext);\n}\n\nvar PopoverPanelContext = /*#__PURE__*/createContext(null);\nPopoverPanelContext.displayName = 'PopoverPanelContext';\n\nfunction usePopoverPanelContext() {\n  return useContext(PopoverPanelContext);\n}\n\nfunction stateReducer(state, action) {\n  return match(action.type, reducers, state, action);\n} // ---\n\n\nvar DEFAULT_POPOVER_TAG = 'div';\nfunction Popover(props) {\n  var _match2;\n\n  var buttonId = \"headlessui-popover-button-\" + useId();\n  var panelId = \"headlessui-popover-panel-\" + useId();\n  var reducerBag = useReducer(stateReducer, {\n    popoverState: PopoverStates.Closed,\n    button: null,\n    buttonId: buttonId,\n    panel: null,\n    panelId: panelId\n  });\n  var _reducerBag$ = reducerBag[0],\n      popoverState = _reducerBag$.popoverState,\n      button = _reducerBag$.button,\n      panel = _reducerBag$.panel,\n      dispatch = reducerBag[1];\n  useEffect(function () {\n    return dispatch({\n      type: ActionTypes.SetButtonId,\n      buttonId: buttonId\n    });\n  }, [buttonId, dispatch]);\n  useEffect(function () {\n    return dispatch({\n      type: ActionTypes.SetPanelId,\n      panelId: panelId\n    });\n  }, [panelId, dispatch]);\n  var registerBag = useMemo(function () {\n    return {\n      buttonId: buttonId,\n      panelId: panelId,\n      close: function close() {\n        return dispatch({\n          type: ActionTypes.ClosePopover\n        });\n      }\n    };\n  }, [buttonId, panelId, dispatch]);\n  var groupContext = usePopoverGroupContext();\n  var registerPopover = groupContext == null ? void 0 : groupContext.registerPopover;\n  var isFocusWithinPopoverGroup = useCallback(function () {\n    var _groupContext$isFocus;\n\n    return (_groupContext$isFocus = groupContext == null ? void 0 : groupContext.isFocusWithinPopoverGroup()) != null ? _groupContext$isFocus : (button == null ? void 0 : button.contains(document.activeElement)) || (panel == null ? void 0 : panel.contains(document.activeElement));\n  }, [groupContext, button, panel]);\n  useEffect(function () {\n    return registerPopover == null ? void 0 : registerPopover(registerBag);\n  }, [registerPopover, registerBag]); // Handle focus out\n\n  useWindowEvent('focus', function () {\n    if (popoverState !== PopoverStates.Open) return;\n    if (isFocusWithinPopoverGroup()) return;\n    if (!button) return;\n    if (!panel) return;\n    dispatch({\n      type: ActionTypes.ClosePopover\n    });\n  }, true); // Handle outside click\n\n  useWindowEvent('mousedown', function (event) {\n    var target = event.target;\n    if (popoverState !== PopoverStates.Open) return;\n    if (button == null ? void 0 : button.contains(target)) return;\n    if (panel == null ? void 0 : panel.contains(target)) return;\n    dispatch({\n      type: ActionTypes.ClosePopover\n    });\n\n    if (!isFocusableElement(target, FocusableMode.Loose)) {\n      event.preventDefault();\n      button == null ? void 0 : button.focus();\n    }\n  });\n  var close = useCallback(function (focusableElement) {\n    dispatch({\n      type: ActionTypes.ClosePopover\n    });\n\n    var restoreElement = function () {\n      if (!focusableElement) return button;\n      if (focusableElement instanceof HTMLElement) return focusableElement;\n      if (focusableElement.current instanceof HTMLElement) return focusableElement.current;\n      return button;\n    }();\n\n    restoreElement == null ? void 0 : restoreElement.focus();\n  }, [dispatch, button]);\n  var api = useMemo(function () {\n    return {\n      close: close\n    };\n  }, [close]);\n  var slot = useMemo(function () {\n    return {\n      open: popoverState === PopoverStates.Open,\n      close: close\n    };\n  }, [popoverState, close]);\n  return React.createElement(PopoverContext.Provider, {\n    value: reducerBag\n  }, React.createElement(PopoverAPIContext.Provider, {\n    value: api\n  }, React.createElement(OpenClosedProvider, {\n    value: match(popoverState, (_match2 = {}, _match2[PopoverStates.Open] = State.Open, _match2[PopoverStates.Closed] = State.Closed, _match2))\n  }, render({\n    props: props,\n    slot: slot,\n    defaultTag: DEFAULT_POPOVER_TAG,\n    name: 'Popover'\n  }))));\n} // ---\n\nvar DEFAULT_BUTTON_TAG = 'button';\nvar Button = /*#__PURE__*/forwardRefWithAs(function Button(props, ref) {\n  var _usePopoverContext = usePopoverContext([Popover.name, Button.name].join('.')),\n      state = _usePopoverContext[0],\n      dispatch = _usePopoverContext[1];\n\n  var internalButtonRef = useRef(null);\n  var groupContext = usePopoverGroupContext();\n  var closeOthers = groupContext == null ? void 0 : groupContext.closeOthers;\n  var panelContext = usePopoverPanelContext();\n  var isWithinPanel = panelContext === null ? false : panelContext === state.panelId;\n  var buttonRef = useSyncRefs(internalButtonRef, ref, isWithinPanel ? null : function (button) {\n    return dispatch({\n      type: ActionTypes.SetButton,\n      button: button\n    });\n  });\n  var withinPanelButtonRef = useSyncRefs(internalButtonRef, ref); // TODO: Revisit when handling Tab/Shift+Tab when using Portal's\n\n  var activeElementRef = useRef(null);\n  var previousActiveElementRef = useRef(typeof window === 'undefined' ? null : document.activeElement);\n  useWindowEvent('focus', function () {\n    previousActiveElementRef.current = activeElementRef.current;\n    activeElementRef.current = document.activeElement;\n  }, true);\n  var handleKeyDown = useCallback(function (event) {\n    var _state$button;\n\n    if (isWithinPanel) {\n      if (state.popoverState === PopoverStates.Closed) return;\n\n      switch (event.key) {\n        case Keys.Space:\n        case Keys.Enter:\n          event.preventDefault(); // Prevent triggering a *click* event\n\n          event.stopPropagation();\n          dispatch({\n            type: ActionTypes.ClosePopover\n          });\n          (_state$button = state.button) == null ? void 0 : _state$button.focus(); // Re-focus the original opening Button\n\n          break;\n      }\n    } else {\n      switch (event.key) {\n        case Keys.Space:\n        case Keys.Enter:\n          event.preventDefault(); // Prevent triggering a *click* event\n\n          event.stopPropagation();\n          if (state.popoverState === PopoverStates.Closed) closeOthers == null ? void 0 : closeOthers(state.buttonId);\n          dispatch({\n            type: ActionTypes.TogglePopover\n          });\n          break;\n\n        case Keys.Escape:\n          if (state.popoverState !== PopoverStates.Open) return closeOthers == null ? void 0 : closeOthers(state.buttonId);\n          if (!internalButtonRef.current) return;\n          if (!internalButtonRef.current.contains(document.activeElement)) return;\n          event.preventDefault();\n          event.stopPropagation();\n          dispatch({\n            type: ActionTypes.ClosePopover\n          });\n          break;\n\n        case Keys.Tab:\n          if (state.popoverState !== PopoverStates.Open) return;\n          if (!state.panel) return;\n          if (!state.button) return; // TODO: Revisit when handling Tab/Shift+Tab when using Portal's\n\n          if (event.shiftKey) {\n            var _state$button2;\n\n            // Check if the last focused element exists, and check that it is not inside button or panel itself\n            if (!previousActiveElementRef.current) return;\n            if ((_state$button2 = state.button) == null ? void 0 : _state$button2.contains(previousActiveElementRef.current)) return;\n            if (state.panel.contains(previousActiveElementRef.current)) return; // Check if the last focused element is *after* the button in the DOM\n\n            var focusableElements = getFocusableElements();\n            var previousIdx = focusableElements.indexOf(previousActiveElementRef.current);\n            var buttonIdx = focusableElements.indexOf(state.button);\n            if (buttonIdx > previousIdx) return;\n            event.preventDefault();\n            event.stopPropagation();\n            focusIn(state.panel, Focus.Last);\n          } else {\n            event.preventDefault();\n            event.stopPropagation();\n            focusIn(state.panel, Focus.First);\n          }\n\n          break;\n      }\n    }\n  }, [dispatch, state.popoverState, state.buttonId, state.button, state.panel, internalButtonRef, closeOthers, isWithinPanel]);\n  var handleKeyUp = useCallback(function (event) {\n    var _state$button3;\n\n    if (isWithinPanel) return;\n\n    if (event.key === Keys.Space) {\n      // Required for firefox, event.preventDefault() in handleKeyDown for\n      // the Space key doesn't cancel the handleKeyUp, which in turn\n      // triggers a *click*.\n      event.preventDefault();\n    }\n\n    if (state.popoverState !== PopoverStates.Open) return;\n    if (!state.panel) return;\n    if (!state.button) return; // TODO: Revisit when handling Tab/Shift+Tab when using Portal's\n\n    switch (event.key) {\n      case Keys.Tab:\n        // Check if the last focused element exists, and check that it is not inside button or panel itself\n        if (!previousActiveElementRef.current) return;\n        if ((_state$button3 = state.button) == null ? void 0 : _state$button3.contains(previousActiveElementRef.current)) return;\n        if (state.panel.contains(previousActiveElementRef.current)) return; // Check if the last focused element is *after* the button in the DOM\n\n        var focusableElements = getFocusableElements();\n        var previousIdx = focusableElements.indexOf(previousActiveElementRef.current);\n        var buttonIdx = focusableElements.indexOf(state.button);\n        if (buttonIdx > previousIdx) return;\n        event.preventDefault();\n        event.stopPropagation();\n        focusIn(state.panel, Focus.Last);\n        break;\n    }\n  }, [state.popoverState, state.panel, state.button, isWithinPanel]);\n  var handleClick = useCallback(function (event) {\n    if (isDisabledReactIssue7711(event.currentTarget)) return;\n    if (props.disabled) return;\n\n    if (isWithinPanel) {\n      var _state$button4;\n\n      dispatch({\n        type: ActionTypes.ClosePopover\n      });\n      (_state$button4 = state.button) == null ? void 0 : _state$button4.focus(); // Re-focus the original opening Button\n    } else {\n      var _state$button5;\n\n      if (state.popoverState === PopoverStates.Closed) closeOthers == null ? void 0 : closeOthers(state.buttonId);\n      (_state$button5 = state.button) == null ? void 0 : _state$button5.focus();\n      dispatch({\n        type: ActionTypes.TogglePopover\n      });\n    }\n  }, [dispatch, state.button, state.popoverState, state.buttonId, props.disabled, closeOthers, isWithinPanel]);\n  var slot = useMemo(function () {\n    return {\n      open: state.popoverState === PopoverStates.Open\n    };\n  }, [state]);\n  var type = useResolveButtonType(props, internalButtonRef);\n  var passthroughProps = props;\n  var propsWeControl = isWithinPanel ? {\n    ref: withinPanelButtonRef,\n    type: type,\n    onKeyDown: handleKeyDown,\n    onClick: handleClick\n  } : {\n    ref: buttonRef,\n    id: state.buttonId,\n    type: type,\n    'aria-expanded': props.disabled ? undefined : state.popoverState === PopoverStates.Open,\n    'aria-controls': state.panel ? state.panelId : undefined,\n    onKeyDown: handleKeyDown,\n    onKeyUp: handleKeyUp,\n    onClick: handleClick\n  };\n  return render({\n    props: _extends({}, passthroughProps, propsWeControl),\n    slot: slot,\n    defaultTag: DEFAULT_BUTTON_TAG,\n    name: 'Popover.Button'\n  });\n}); // ---\n\nvar DEFAULT_OVERLAY_TAG = 'div';\nvar OverlayRenderFeatures = Features.RenderStrategy | Features.Static;\nvar Overlay = /*#__PURE__*/forwardRefWithAs(function Overlay(props, ref) {\n  var _usePopoverContext2 = usePopoverContext([Popover.name, Overlay.name].join('.')),\n      popoverState = _usePopoverContext2[0].popoverState,\n      dispatch = _usePopoverContext2[1];\n\n  var overlayRef = useSyncRefs(ref);\n  var id = \"headlessui-popover-overlay-\" + useId();\n  var usesOpenClosedState = useOpenClosed();\n\n  var visible = function () {\n    if (usesOpenClosedState !== null) {\n      return usesOpenClosedState === State.Open;\n    }\n\n    return popoverState === PopoverStates.Open;\n  }();\n\n  var handleClick = useCallback(function (event) {\n    if (isDisabledReactIssue7711(event.currentTarget)) return event.preventDefault();\n    dispatch({\n      type: ActionTypes.ClosePopover\n    });\n  }, [dispatch]);\n  var slot = useMemo(function () {\n    return {\n      open: popoverState === PopoverStates.Open\n    };\n  }, [popoverState]);\n  var propsWeControl = {\n    ref: overlayRef,\n    id: id,\n    'aria-hidden': true,\n    onClick: handleClick\n  };\n  var passthroughProps = props;\n  return render({\n    props: _extends({}, passthroughProps, propsWeControl),\n    slot: slot,\n    defaultTag: DEFAULT_OVERLAY_TAG,\n    features: OverlayRenderFeatures,\n    visible: visible,\n    name: 'Popover.Overlay'\n  });\n}); // ---\n\nvar DEFAULT_PANEL_TAG = 'div';\nvar PanelRenderFeatures = Features.RenderStrategy | Features.Static;\nvar Panel = /*#__PURE__*/forwardRefWithAs(function Panel(props, ref) {\n  var _props$focus = props.focus,\n      focus = _props$focus === void 0 ? false : _props$focus,\n      passthroughProps = _objectWithoutPropertiesLoose(props, [\"focus\"]);\n\n  var _usePopoverContext3 = usePopoverContext([Popover.name, Panel.name].join('.')),\n      state = _usePopoverContext3[0],\n      dispatch = _usePopoverContext3[1];\n\n  var _usePopoverAPIContext = usePopoverAPIContext([Popover.name, Panel.name].join('.')),\n      close = _usePopoverAPIContext.close;\n\n  var internalPanelRef = useRef(null);\n  var panelRef = useSyncRefs(internalPanelRef, ref, function (panel) {\n    dispatch({\n      type: ActionTypes.SetPanel,\n      panel: panel\n    });\n  });\n  var usesOpenClosedState = useOpenClosed();\n\n  var visible = function () {\n    if (usesOpenClosedState !== null) {\n      return usesOpenClosedState === State.Open;\n    }\n\n    return state.popoverState === PopoverStates.Open;\n  }();\n\n  var handleKeyDown = useCallback(function (event) {\n    var _state$button6;\n\n    switch (event.key) {\n      case Keys.Escape:\n        if (state.popoverState !== PopoverStates.Open) return;\n        if (!internalPanelRef.current) return;\n        if (!internalPanelRef.current.contains(document.activeElement)) return;\n        event.preventDefault();\n        event.stopPropagation();\n        dispatch({\n          type: ActionTypes.ClosePopover\n        });\n        (_state$button6 = state.button) == null ? void 0 : _state$button6.focus();\n        break;\n    }\n  }, [state, internalPanelRef, dispatch]); // Unlink on \"unmount\" myself\n\n  useEffect(function () {\n    return function () {\n      return dispatch({\n        type: ActionTypes.SetPanel,\n        panel: null\n      });\n    };\n  }, [dispatch]); // Unlink on \"unmount\" children\n\n  useEffect(function () {\n    var _props$unmount;\n\n    if (props[\"static\"]) return;\n\n    if (state.popoverState === PopoverStates.Closed && ((_props$unmount = props.unmount) != null ? _props$unmount : true)) {\n      dispatch({\n        type: ActionTypes.SetPanel,\n        panel: null\n      });\n    }\n  }, [state.popoverState, props.unmount, props[\"static\"], dispatch]); // Move focus within panel\n\n  useEffect(function () {\n    if (!focus) return;\n    if (state.popoverState !== PopoverStates.Open) return;\n    if (!internalPanelRef.current) return;\n    var activeElement = document.activeElement;\n    if (internalPanelRef.current.contains(activeElement)) return; // Already focused within Dialog\n\n    focusIn(internalPanelRef.current, Focus.First);\n  }, [focus, internalPanelRef, state.popoverState]); // Handle Tab / Shift+Tab focus positioning\n\n  useWindowEvent('keydown', function (event) {\n    if (state.popoverState !== PopoverStates.Open) return;\n    if (!internalPanelRef.current) return;\n    if (event.key !== Keys.Tab) return;\n    if (!document.activeElement) return;\n    if (!internalPanelRef.current) return;\n    if (!internalPanelRef.current.contains(document.activeElement)) return; // We will take-over the default tab behaviour so that we have a bit\n    // control over what is focused next. It will behave exactly the same,\n    // but it will also \"fix\" some issues based on whether you are using a\n    // Portal or not.\n\n    event.preventDefault();\n    var result = focusIn(internalPanelRef.current, event.shiftKey ? Focus.Previous : Focus.Next);\n\n    if (result === FocusResult.Underflow) {\n      var _state$button7;\n\n      return (_state$button7 = state.button) == null ? void 0 : _state$button7.focus();\n    } else if (result === FocusResult.Overflow) {\n      if (!state.button) return;\n      var elements = getFocusableElements();\n      var buttonIdx = elements.indexOf(state.button);\n      var nextElements = elements.splice(buttonIdx + 1) // Elements after button\n      .filter(function (element) {\n        var _internalPanelRef$cur;\n\n        return !((_internalPanelRef$cur = internalPanelRef.current) == null ? void 0 : _internalPanelRef$cur.contains(element));\n      }); // Ignore items in panel\n      // Try to focus the next element, however it could fail if we are in a\n      // Portal that happens to be the very last one in the DOM. In that\n      // case we would Error (because nothing after the button is\n      // focusable). Therefore we will try and focus the very first item in\n      // the document.body.\n\n      if (focusIn(nextElements, Focus.First) === FocusResult.Error) {\n        focusIn(document.body, Focus.First);\n      }\n    }\n  }); // Handle focus out when we are in special \"focus\" mode\n\n  useWindowEvent('focus', function () {\n    var _internalPanelRef$cur2;\n\n    if (!focus) return;\n    if (state.popoverState !== PopoverStates.Open) return;\n    if (!internalPanelRef.current) return;\n    if ((_internalPanelRef$cur2 = internalPanelRef.current) == null ? void 0 : _internalPanelRef$cur2.contains(document.activeElement)) return;\n    dispatch({\n      type: ActionTypes.ClosePopover\n    });\n  }, true);\n  var slot = useMemo(function () {\n    return {\n      open: state.popoverState === PopoverStates.Open,\n      close: close\n    };\n  }, [state, close]);\n  var propsWeControl = {\n    ref: panelRef,\n    id: state.panelId,\n    onKeyDown: handleKeyDown\n  };\n  return React.createElement(PopoverPanelContext.Provider, {\n    value: state.panelId\n  }, render({\n    props: _extends({}, passthroughProps, propsWeControl),\n    slot: slot,\n    defaultTag: DEFAULT_PANEL_TAG,\n    features: PanelRenderFeatures,\n    visible: visible,\n    name: 'Popover.Panel'\n  }));\n}); // ---\n\nvar DEFAULT_GROUP_TAG = 'div';\n\nfunction Group(props) {\n  var groupRef = useRef(null);\n\n  var _useState = useState([]),\n      popovers = _useState[0],\n      setPopovers = _useState[1];\n\n  var unregisterPopover = useCallback(function (registerbag) {\n    setPopovers(function (existing) {\n      var idx = existing.indexOf(registerbag);\n\n      if (idx !== -1) {\n        var clone = existing.slice();\n        clone.splice(idx, 1);\n        return clone;\n      }\n\n      return existing;\n    });\n  }, [setPopovers]);\n  var registerPopover = useCallback(function (registerbag) {\n    setPopovers(function (existing) {\n      return [].concat(existing, [registerbag]);\n    });\n    return function () {\n      return unregisterPopover(registerbag);\n    };\n  }, [setPopovers, unregisterPopover]);\n  var isFocusWithinPopoverGroup = useCallback(function () {\n    var _groupRef$current;\n\n    var element = document.activeElement;\n    if ((_groupRef$current = groupRef.current) == null ? void 0 : _groupRef$current.contains(element)) return true; // Check if the focus is in one of the button or panel elements. This is important in case you are rendering inside a Portal.\n\n    return popovers.some(function (bag) {\n      var _document$getElementB, _document$getElementB2;\n\n      return ((_document$getElementB = document.getElementById(bag.buttonId)) == null ? void 0 : _document$getElementB.contains(element)) || ((_document$getElementB2 = document.getElementById(bag.panelId)) == null ? void 0 : _document$getElementB2.contains(element));\n    });\n  }, [groupRef, popovers]);\n  var closeOthers = useCallback(function (buttonId) {\n    for (var _iterator = _createForOfIteratorHelperLoose(popovers), _step; !(_step = _iterator()).done;) {\n      var popover = _step.value;\n      if (popover.buttonId !== buttonId) popover.close();\n    }\n  }, [popovers]);\n  var contextBag = useMemo(function () {\n    return {\n      registerPopover: registerPopover,\n      unregisterPopover: unregisterPopover,\n      isFocusWithinPopoverGroup: isFocusWithinPopoverGroup,\n      closeOthers: closeOthers\n    };\n  }, [registerPopover, unregisterPopover, isFocusWithinPopoverGroup, closeOthers]);\n  var slot = useMemo(function () {\n    return {};\n  }, []);\n  var propsWeControl = {\n    ref: groupRef\n  };\n  var passthroughProps = props;\n  return React.createElement(PopoverGroupContext.Provider, {\n    value: contextBag\n  }, render({\n    props: _extends({}, passthroughProps, propsWeControl),\n    slot: slot,\n    defaultTag: DEFAULT_GROUP_TAG,\n    name: 'Popover.Group'\n  }));\n} // ---\n\n\nPopover.Button = Button;\nPopover.Overlay = Overlay;\nPopover.Panel = Panel;\nPopover.Group = Group;\n\nexport { Popover };\n"]},"metadata":{},"sourceType":"module"}